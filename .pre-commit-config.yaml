# Local pre-commit configuration to enforce project quality gates and TDD policy.
# Uses local hooks to avoid network dependency and to run in the active Python env.

repos:
  - repo: local
    hooks:
      - id: formatall
        name: Format and Lint (Black, isort, Ruff)
        entry: bin/formatall
        language: system
        types: [python]
        files: ^(?!bin/|tmp_).*
        pass_filenames: false
      - id: mypy-app
        name: MyPy (app)
        entry: mypy afs_fastapi/api/ afs_fastapi/core/ afs_fastapi/database/ afs_fastapi/monitoring/ afs_fastapi/equipment/ afs_fastapi/services/ afs_fastapi/models/ afs_fastapi/protocols/ afs_fastapi/safety/ afs_fastapi/scripts/ afs_fastapi/stations/
        language: system
        types: [python]
        files: ^afs_fastapi/.*\.py$
        pass_filenames: false
      - id: mypy-tests
        name: MyPy (tests)
        entry: mypy tests/
        language: system
        types: [python]
        files: ^tests/.*\.py$
        pass_filenames: false
      # - id: pytest
      #   name: Pytest (unit tests)
      #   entry: pytest
      #   language: system
      #   types: [python]
      #   files: ^(?!bin/|tmp_).*
      #   pass_filenames: false
      #   always_run: true

      # Mandatory TDD enforcement (always runs on commit)
      - id: tdd-enforcement
        name: TDD Enforcement
        entry: python .claude/hooks/tdd_enforcement.py
        language: system
        pass_filenames: false
        always_run: true

      # Safety standards validation (ISO 18497 alignment gates)
      - id: safety-validation
        name: Safety Standards Validation
        entry: python .claude/hooks/safety_validation.py
        language: system
        pass_filenames: false
        always_run: true

      - id: doc-update-reminder
        name: Documentation Update Reminder
        entry: bash tools/doc_update_reminder.sh
        language: system
        pass_filenames: false
        always_run: true





